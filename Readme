Based on paper A Tutorial on HMM by Rabiner